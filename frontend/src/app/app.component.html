<!-- Modern Navigation Bar -->
<nav class="glass-nav">
    <div class="nav-content">
        <!-- Brand -->
        <div class="brand" (click)="switchView('shop')">TECH<span>PRO</span></div>

        <!-- Main Navigation Links -->
        <div class="main-menu">
            <a (click)="switchView('shop')" [class.active]="currentView === 'shop'">Store</a>
            <a (click)="switchView('admin')" [class.active]="currentView === 'admin'">Admin Console</a>
            <a href="#">Support</a>
        </div>

        <!-- Right Side Actions -->
        <div class="nav-actions">
            <div class="search-box" *ngIf="currentView === 'shop'">
                <span>üîç</span>
                <input [(ngModel)]="searchQuery" placeholder="Find premium tech..." type="text">
            </div>

            <button class="cart-btn" *ngIf="currentView === 'shop'" (click)="toggleCart()">
                <span class="icon">üõí</span>
                <span class="badge" *ngIf="cart.length">{{ cart.length }}</span>
            </button>
        </div>
    </div>
</nav>

<!-- Sub-Navigation for Categories -->
<div class="sub-nav" *ngIf="currentView === 'shop'">
    <div class="category-links">
        <button *ngFor="let cat of categories" [class.selected]="currentCategory === cat"
            (click)="currentCategory = cat">
            {{ cat }}
        </button>
    </div>
</div>

<div class="page-wrapper" [class.blurred-bg]="isCartOpen">

    <!-- SHOPPING VIEW -->
    <div *ngIf="currentView === 'shop'" class="animate-fade">
        <header class="hero-section">
            <div class="hero-text">
                <span class="upper-title">Next-Gen Technology Hub</span>
                <h1>Upgrade Your Workspace</h1>
                <p>Premium curated collection of High-Performance hardware for Developers and Creatives.</p>
            </div>
        </header>

        <main class="store-grid">
            <div class="grid-header">
                <h2>{{ currentCategory }} Products</h2>
                <span>{{ filteredProducts.length }} items available</span>
            </div>

            <div class="products-container">
                <div class="store-card" *ngFor="let product of filteredProducts">
                    <div class="card-media">
                        <img [src]="product.imageUrl" [alt]="product.name"
                            onerror="this.src='https://images.unsplash.com/photo-1550745165-9bc0b252726f?w=400'">
                        <div class="item-tag">{{ product.category }}</div>
                        <button class="add-to-cart-overlay" (click)="addToCart(product)">Add to Cart</button>
                    </div>
                    <div class="card-details">
                        <h3>{{ product.name }}</h3>
                        <p class="desc">{{ product.description }}</p>
                        <div class="card-row">
                            <span class="price-val">${{ product.price | number:'1.2-2' }}</span>
                            <div class="vibrant-stock">‚óè In Stock</div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- ADMIN DASHBOARD VIEW -->
    <div *ngIf="currentView === 'admin'" class="admin-view animate-fade">
        <div class="admin-hero">
            <div class="hero-inner">
                <h1>Command Center</h1>
                <p>Real-time analytics and order orchestration platform.</p>
            </div>
        </div>

        <div class="admin-content">
            <div class="analytics-row">
                <div class="metric">
                    <label>Total Volume</label>
                    <div class="val">{{ orders.length }} Orders</div>
                </div>
                <div class="metric">
                    <label>Gross Revenue</label>
                    <div class="val highlight">${{ totalRevenue | number:'1.2-2' }}</div>
                </div>
                <div class="metric">
                    <label>Platform Status</label>
                    <div class="val success">Operational</div>
                </div>
            </div>

            <div class="orders-section">
                <div class="section-top">
                    <h3>Recent Transactions</h3>
                    <button (click)="loadOrders()" class="sync-btn">Refresh Data</button>
                </div>

                <div class="table-container">
                    <table class="pro-table">
                        <thead>
                            <tr>
                                <th>Order ID</th>
                                <th>Customer Details</th>
                                <th>Products Purchased</th>
                                <th>Purchase Date</th>
                                <th>Total</th>
                                <th>Status</th>
                                <th>Orchestration</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr *ngFor="let order of orders">
                                <td><span class="id-badge">#{{ order.id }}</span></td>
                                <td>
                                    <div class="cust-info">
                                        <b>{{ order.customerName }}</b>
                                        <span>{{ order.customerEmail }}</span>
                                    </div>
                                </td>
                                <td>
                                    <div class="items-list">
                                        <span *ngFor="let p of order.productNames">{{ p }}</span>
                                    </div>
                                </td>
                                <td>{{ order.orderDate | date:'medium' }}</td>
                                <td class="total-col">${{ order.totalAmount | number:'1.2-2' }}</td>
                                <td><span class="status-pill" [attr.data-status]="order.status">{{ order.status
                                        }}</span></td>
                                <td>
                                    <div class="control-btns">
                                        <button (click)="updateOrderStatus(order.id!, 'SHIPPED')"
                                            *ngIf="order.status === 'PENDING'" class="ship">Process Ship</button>
                                        <button (click)="updateOrderStatus(order.id!, 'DELIVERED')"
                                            *ngIf="order.status === 'SHIPPED'" class="deliver">Complete</button>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <div *ngIf="orders.length === 0" class="empty-orders">
                        <p>No transactions detected in the system.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Sliding Cart Drawer -->
<div class="cart-drawer" [class.drawer-open]="isCartOpen">
    <div class="drawer-header">
        <h2>Your Cart ({{ cart.length }})</h2>
        <button class="close-drawer" (click)="toggleCart()">‚úï</button>
    </div>

    <div class="drawer-body">
        <div class="cart-scroll-area" *ngIf="cart.length > 0">
            <div class="cart-item-card" *ngFor="let item of cart; let i = index">
                <img [src]="item.imageUrl" [alt]="item.name">
                <div class="item-meta">
                    <h4>{{ item.name }}</h4>
                    <span class="item-price">${{ item.price | number:'1.2-2' }}</span>
                </div>
                <button class="delete-item" (click)="removeFromCart(i)">üóë</button>
            </div>
        </div>
        <div class="empty-cart-state" *ngIf="cart.length === 0">
            <div class="placeholder-icon">üõí</div>
            <p>Your shopping cart is waiting for premium tech.</p>
        </div>
    </div>

    <div class="drawer-footer" *ngIf="cart.length > 0">
        <div class="summary-total">
            <span>Subtotal</span>
            <span>${{ total | number:'1.2-2' }}</span>
        </div>
        <div class="checkout-gui">
            <div class="gui-input">
                <label>Shipping Name</label>
                <input [(ngModel)]="customer.name" placeholder="Full Name" type="text">
            </div>
            <div class="gui-input">
                <label>Email Receipt</label>
                <input [(ngModel)]="customer.email" placeholder="email@example.com" type="email">
            </div>
            <button class="finish-order-btn" (click)="checkout()" [disabled]="!customer.name || !customer.email">
                Verify and Place Order
            </button>
        </div>
    </div>
</div>

<!-- Order Confirmation Overlay -->
<div class="modal-overlay" *ngIf="orderPlaced">
    <div class="modal-content">
        <div class="success-ring">‚úì</div>
        <h2>Transaction Successful</h2>
        <p>Order for <b>${{ lastOrderTotal | number:'1.2-2' }}</b> has been processed.</p>
        <button (click)="orderPlaced = false" class="return-btn">Continue Shopping</button>
    </div>
</div>

<footer class="pro-footer">
    <div class="footer-wrap">
        <div class="footer-logo">TECH<span>PRO</span></div>
        <p>Advanced Microservices & GitOps Showcase Platform</p>
        <div class="social-sim">
            <span>LinkedIn</span> ‚Ä¢ <span>GitHub</span> ‚Ä¢ <span>Twitter</span>
        </div>
    </div>
</footer>